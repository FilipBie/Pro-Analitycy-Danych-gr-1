---
title: "Analiza opisowa"
author: "Wanesa"
date: "2025-01-22"
output: html_document
---
<<<<<<< HEAD
## WALIDACJA DANYCH 
```{r}
# Funkcja zamieniająca wszystkie puste wartości na NA
apartments_rent_pl_2024_06[apartments_rent_pl_2024_06 == ""] <- NA

# Wyświetlenie zaktualizowanego apartments_rent_pl_2024_06frame
print(apartments_rent_pl_2024_06)


library(openxlsx)
write.xlsx(apartments_rent_pl_2024_06, file = "NaszeDane.xlsx")

# Wczytanie danych
library(readxl)
```
Walidacja danych w analizie to proces sprawdzania poprawności, spójności i kompletności danych przed ich użyciem. Celem jest wykrycie i eliminacja błędów, takich jak duplikaty, brakujące wartości czy nieprawidłowe formaty.

=======

WIZUALIZACJA DANCYCH

Odpowiednio przygotowane dane pozwolą na zilustowanie ich charakterystyk i rozkładów. Poniżej przedstawione zostały wybrane wizualizacje badanych danych

1.  Średnie wartości cen wynajmu w Polsce - mapa

```{r include=FALSE}
library(dplyr)
srednie_ceny <- Imputed_Data_Combined %>%
  group_by(city) %>%
  summarise(srednie_ceny = mean(price))
print(srednie_ceny)

install.packages(c("maps", "mapdata", "ggplot2"))

library(maps)
library(mapdata)
library(ggplot2)
```

```{r echo=FALSE}
poland_map <- map_data("worldHires", region = "Poland")


# dane
cities <- data.frame(
  city = c("Białystok", "Bydgoszcz", "Częstochowa", "Gdańsk", "Gdynia", "Katowice", "Kraków", "Łódź", "Lublin", "Poznań", "Radom", "Rzeszów", "Szczecin", "Warszawa", "Wrocław"),
  lon = c(23.1667, 18.0000, 19.1167, 18.6333, 18.5333, 19.0000, 19.9500, 19.4667, 
          22.5667, 16.9167, 21.1667, 22.0167, 14.5667, 21.0333, 17.0333),
  lat  = c(53.1333, 53.1167, 50.8000, 54.3667, 54.5333, 50.2500, 50.0500, 51.7833, 
          51.2333, 52.4167, 51.4000, 50.0500, 53.4333, 52.2000, 51.1167),
  price = c(1928, 1987, 1915, 3213, 3317, 2411, 3317, 2110, 2570, 2593, 1851, 2521, 2627, 5090, 3172) 
)

# mapa 
ggplot() +
  geom_polygon(data = poland_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
  geom_point(data = cities, aes(x = lon, y = lat, size = price), alpha = 0.7, color = "darkmagenta") +  
  scale_size_continuous(range = c(3, 10)) +  
  geom_text(data = cities, aes(x = lon, y = lat, label = city), vjust = -1, size = 3, color = "black") +  
  labs(title = "Średnie ceny wynajmu w Polsce", size = "Cena [PLN]") +
  theme_minimal()
```

Warszawa wyróżnia się najwyższymi średnimi cenami wynajmu w Polsce, co wynika z jej roli gospodarczego i edukacyjnego centrum kraju. Duże miasta, takie jak Gdańsk, Kraków czy Wrocław, również odnotowują wysokie koszty, głównie ze względu na turystykę i rozwój biznesowy. W mniejszych miastach, takich jak Radom czy Białystok, ceny są znacznie niższe, co może wynikać z mniejszego popytu i ograniczonej urbanizacji.

2.Rozkłady

a)  rozkład liczby pokoi

```{r}
 ggplot(Imputed_Data_Combined, aes(x = rooms)) +
    geom_histogram(binwidth = 1, fill = "violetred3", color = "black", alpha = 0.7) +
    labs(title = "Rozkład liczby pokoi",
         x = "Liczba pokoi", y = "Liczba mieszkań") +
    theme_minimal()
```

Wykres przedstawia rozkład liczby pokoi w mieszkaniach dostępnych na wynajem. Najwięcej ofert dotyczy mieszkań dwupokojowych, które dominują na rynku, co może wynikać z ich uniwersalności i popularności wśród wynajmujących. Mieszkania jednopokojowe i trzypokojowe stanowią mniejszą, choć znaczną część rynku, sugerując zróżnicowanie potrzeb najemców. Mieszkania cztero- i więcej pokojowe są rzadkością, co może oznaczać ograniczoną dostępność takich lokali lub niski popyt w tej kategorii.

b)liczba mieszkań z windą i bez windy w różnych miastach

```{r}
liczba_mieszkan_z_winda <- Imputed_Data_Combined %>%
    group_by(city, hasElevator) %>%
    summarise(count = n())
  
  ggplot(liczba_mieszkan_z_winda, aes(x = reorder(city, count), y = count, fill = hasElevator)) +
    geom_bar(stat = "identity", position = "dodge", alpha = 0.7) +  
    labs(title = "Liczba mieszkań z windą i bez windy w różnych miastach",
         x = "Miasto", y = "Liczba mieszkań") +
    scale_fill_manual(values = c("thistle", "deeppink4")) +  
    coord_flip() + 
    theme_minimal() +
    theme(
      legend.position = "top",  
      axis.text.x = element_text(angle = 45, hjust = 1),
      plot.title = element_text(size = 14, hjust = 0.5)
    )

```

<<<<<<< HEAD
=======
Wykres przedstawia liczbę mieszkań z windą i bez windy w różnych miastach Polski. Warszawa wyraźnie dominuje pod względem liczby mieszkań, zarówno z windą, jak i bez niej, co potwierdza jej pozycję największego rynku mieszkaniowego w kraju. Miasta takie jak Kraków, Wrocław czy Łódź mają znaczącą liczbę mieszkań z windą, co świadczy o rozwoju nowoczesnej infrastruktury mieszkaniowej. W mniejszych miastach, takich jak Radom czy Białystok, liczba mieszkań bez windy przeważa, co może wynikać z obecności starszego budownictwa lub mniejszego zapotrzebowania na takie udogodnienia.

>>>>>>> 2329a76e42540a703feb54fb5ef246d22b6318f6
c)  Liczba mieszkań w poszczególnych miastach

```{r}
 liczba_mieszkan <- Imputed_Data_Combined %>%
    group_by(city) %>%
    summarise(count = n())
  
  
  ggplot(liczba_mieszkan, aes(x = reorder(city, count), y = count, fill = city)) +
    geom_bar(stat = "identity", fill = "mediumorchid4", alpha = 0.7) +
    geom_text(aes(label = count),  
              vjust = -0.3, size = 3.5) +
    labs(title = "Liczba mieszkań w poszczególnych miastach",
         x = "Miasta", y = "Liczba mieszkań") +
    coord_flip() +  
    theme_minimal() +
    theme(
      legend.position = "none",
      axis.text.x = element_text(angle = 45, hjust = 1),
      axis.title = element_text(size = 12),
      plot.title = element_text(size = 14, hjust = 0.5)
    )
  
```

<<<<<<< HEAD
3.  ANALIZA DOSTĘPNOŚCI INFRASTRUKTÓRY
=======
Wykres przedstawia liczbę mieszkań dostępnych w poszczególnych miastach Polski. Warszawa zdecydowanie przoduje z liczbą 3393 mieszkań, co pokazuje jej dominującą pozycję na rynku nieruchomości. Kraków zajmuje drugie miejsce z liczbą 1764 mieszkań, a Wrocław trzecie z 879, co odzwierciedla koncentrację ofert w największych aglomeracjach. Mniejsze miasta, takie jak Radom czy Białystok, mają znacznie mniejszą liczbę mieszkań, co może wynikać z ich wielkości, mniejszego zapotrzebowania na wynajem lub mniej rozwiniętego rynku nieruchomości.

3. ANALIZA DOSTĘPNOŚCI INFRASTRUKTÓRY
>>>>>>> 2329a76e42540a703feb54fb5ef246d22b6318f6

a)Cena wynajmu vs. Odległość od centrum

```{r}
ggplot(Imputed_Data_Combined, aes(x = centreDistance, y = price)) +
    geom_point(alpha = 0.5, color = "orchid4") +  # Punkty na wykresie
    geom_smooth(method = "lm", color = "black", se = TRUE, fill = "gray70") +  # Linia regresji z przedziałem ufności
    labs(title = "Cena wynajmu vs. Odległość od centrum",
         x = "Odległość od centrum [km]",
         y = "Cena wynajmu [PLN]") +
    theme_minimal()
```
Wykres przedstawia zależność między ceną wynajmu a odległością od centrum w kilometrach. Widoczny jest ogólny trend spadkowy – im dalej od centrum, tym niższe ceny wynajmu, co sugeruje, że lokalizacja jest kluczowym czynnikiem wpływającym na koszt wynajmu mieszkania. Wyjątki od tej tendencji, czyli mieszkania o bardzo wysokich cenach w większej odległości od centrum, mogą wynikać z luksusowego standardu lub wyjątkowej lokalizacji. Niemniej jednak większość mieszkań koncentruje się w niższych przedziałach cenowych, co potwierdza, że dystans od centrum pozostaje istotnym determinantem cen.

Wpływ odległości do szkół na cenę mieszkań

```{r}
ggplot(Imputed_Data_Combined, aes(x = schoolDistance, y = price)) +
    geom_point(alpha = 0.5, color = "orchid4") +  # Punkty na wykresie
    geom_smooth(method = "lm", color = "black", se = TRUE, fill = "gray70") +  # Linia regresji z przedziałem ufności
    labs(title = "Odległość do szkoły vs. Cena wynajmu",
         x = "Odległość do szkoły [km]",
         y = "Cena wynajmu [PLN]") +
    theme_minimal()
```
Wykres przedstawia zależność między odległością od szkoły a ceną wynajmu mieszkania. Zauważalny jest delikatny trend spadkowy – im większa odległość od szkoły, tym niższe ceny wynajmu, co sugeruje, że bliskość do placówek edukacyjnych może być atutem podnoszącym koszt wynajmu. Najwyższe ceny mieszkań skupiają się w bliskiej odległości od szkół, co może wynikać z preferencji rodzin z dziećmi lub studentów szukających lokum w pobliżu. Jednak dla odległości powyżej 1-2 km różnice cenowe stają się mniej wyraźne, co wskazuje, że wpływ bliskości szkoły jest najsilniejszy w bezpośrednim sąsiedztwie.

------------------------------------------------------------------------

ANALIZA OPISOWA

Poniższe dane zawierają analizę opisową dla badanej bazy danych

```{r setup, include=FALSE}
knitr::opts_chunk$set(include = FALSE)
# pakiety:
library(dplyr)
library(ggplot2)
library(summarytools)
library(corrplot)
install.packages()
```

Tabela 1. Podstawowe statystyki opisowe dla kluczowych zmiennych

```{r Podstawowe statystyki opisowe dla kluczowych zmiennych, include=FALSE}
key_vars <- c("price", "squareMeters", "rooms", "centreDistance", 
              "schoolDistance", "clinicDistance", "buildYear")
stats <- Imputed_Data_Combined %>%
  select(all_of(key_vars)) %>%
  summarise_all(list(
    Min = ~ min(., na.rm = TRUE),
    Max = ~ max(., na.rm = TRUE),
    Mean = ~ round(mean(., na.rm = TRUE), 2),
    Median = ~ round(median(., na.rm = TRUE), 2),
    SD = ~ round(sd(., na.rm = TRUE), 2),
    Q1 = ~ quantile(., 0.25, na.rm = TRUE),
    Q3 = ~ quantile(., 0.75, na.rm = TRUE)
  ))

```

```{r echo=FALSE}

# Wyświetl wyniki
print(stats)

view(dfSummary(Imputed_Data_Combined %>% select(all_of(key_vars))))
```

2.  Szacowanie korelacji dla wybranych danych ilościowych (cena, ilość pokoi, piętro, dystans od centrum, ilość pięter, rok budowy)

```{r Szacowanie korelacji dla wybranych danych ilościowych, echo=FALSE}
numeric_vars <- Imputed_Data_Combined %>%
  select("price","rooms","floor","centreDistance","floorCount","buildYear") %>%
  na.omit()

cor_matrix <- cor(numeric_vars)
cor_matrix
```
Kluczowe wnioski:

1. Silna korelacja między liczbą pokoi a ceną wynajmu (0.64): Oznacza to, że większa liczba pokoi jest istotnym czynnikiem podnoszącym cenę mieszkania.
2. Wyraźna dodatnia korelacja między liczbą pięter w budynku a piętrem mieszkania (0.67): Wskazuje na logiczną zależność – wyższe mieszkania częściej znajdują się w budynkach o większej liczbie pięter.
3. Brak istotnej korelacji między odległością od centrum a ceną (-0.01): Oznacza, że w analizowanym zestawie danych lokalizacja względem centrum nie wpływa znacząco na cenę wynajmu.
4. Słaba lub ujemna korelacja roku budowy z innymi zmiennymi: Budynki starsze są częściej związane z niższą liczbą pięter oraz ceną, jednak wartości korelacji (-0.02 do 0.15) są zbyt niskie, aby mówić o wyraźnym trendzie.

Ogólnie analiza wskazuje, że cena wynajmu jest najmocniej powiązana z wielkością mieszkania (liczbą pokoi), natomiast lokalizacja i inne czynniki mają słabszy wpływ.

3.  Macierzy oszacowanych korelacji

<<<<<<< HEAD
3.  Macierzy oszacowanych korelacji

=======
>>>>>>> 2329a76e42540a703feb54fb5ef246d22b6318f6
```{r Macierzy oszacowanych korelacji, echo=FALSE}
corrplot(cor_matrix, method = "color", type = "upper", order = "hclust",
         tl.col = "black", tl.srt = 45, addCoef.col = "black")
```
